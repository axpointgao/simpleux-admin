# 商业项目模块功能需求

## 一、功能概述

商业项目模块是系统的核心模块之一，用于管理商业项目的全生命周期，包括项目创建、预算管理、支出管理、变更管理、补录申请、设计确认、归档等功能。

## 二、功能列表

### 2.1 项目创建

**功能描述**：
- 支持创建四种类型的商业项目：项目制、计件制、离岸制、驻场制
- 根据项目类型，系统自动判断是否需要录入预算
- 项目创建需要审批（根据审批流程配置）

**功能要求**：
1. **项目基本信息录入**：
   - 项目名称（必填）
   - 项目类型（必填，下拉选择：项目制/计件制/离岸制/驻场制）
   - 项目经理（必填，下拉选择）
   - 归属部门（必填，下拉选择）
   - 商务经理（必填，文本输入）
   - 客户部（必填，下拉选择）
   - 计划开始日期（必填，日期选择器；离岸制/驻场制非必填）
   - 计划结束日期（必填，日期选择器；离岸制/驻场制非必填）
   - 合同金额（必填，数字输入，单位：元；离岸制/驻场制创建时不录入）

2. **计件制项目特殊字段**：
   - 需求编号（必填，文本输入）
   - 需求名称（必填，文本输入）

3. **预算录入**（项目制和计件制必填，离岸制和驻场制不需要）：
   - 人力预算：按员工级别和城市类型录入人日数和单价
   - 差旅预算：录入差旅事项和各项费用
   - 外包预算：录入外包事项、供应商和金额

4. **审批流程**：
   - 提交项目创建申请后，系统自动创建审批
   - 审批流程根据审批流程模板配置
   - 审批通过后，项目状态自动变为"已确认"

**交互设计**：
- 项目创建表单使用分步骤向导
- 第一步：基本信息录入
- 第二步：预算录入（根据项目类型显示/隐藏）
- 第三步：提交审批

### 2.2 项目列表

**功能描述**：
- 显示所有商业项目列表
- 支持多维度筛选和搜索
- 支持排序和分页

**功能要求**：
1. **列表字段**：
   - 项目名称
   - 项目类型
   - 项目经理
   - 归属部门
   - 客户部
   - 合同金额
   - 项目状态
   - 创建时间
   - 操作按钮（查看详情、编辑、删除）

2. **筛选条件**：
   - 项目类型（下拉选择，多选）
   - 项目状态（下拉选择，多选）
   - 归属部门（下拉选择，多选）
   - 客户部（下拉选择，多选）
   - 项目经理（下拉选择，多选）
   - 项目名称（文本输入，模糊搜索）
   - 创建时间（日期范围选择器）

3. **排序**：
   - 默认按创建时间倒序
   - 支持按合同金额、创建时间、计划开始日期等字段排序

4. **分页**：
   - 每页显示20条记录
   - 支持跳转到指定页码

**交互设计**：
- 列表使用表格展示
- 筛选条件在列表顶部，支持展开/收起
- 支持批量操作（如批量导出）

### 2.3 项目详情

**功能描述**：
- 显示项目的完整信息
- 支持编辑项目基本信息
- 支持查看和管理预算、支出、变更记录等

**功能要求**：
1. **基本信息区域**：
   - 项目名称、项目类型、项目经理、归属部门、商务经理、客户部
   - 计划开始日期、计划结束日期、实际开始日期、实际结束日期
   - 合同金额、项目状态、项目进度
   - 操作按钮（编辑、删除、归档等）

2. **预算管理区域**：
   - 人力预算列表（按员工级别和城市类型分组）
   - 差旅预算列表
   - 外包预算列表
   - 预算汇总（总预算金额）
   - 操作按钮（添加预算、编辑预算、删除预算）

3. **支出管理区域**：
   - 人力支出列表（从Teambition同步或手动录入）
   - 差旅支出列表（手动录入）
   - 外包支出列表（手动录入）
   - 支出汇总（总支出金额）
   - 操作按钮（同步工时、添加支出、编辑支出、删除支出）

4. **成本分析区域**：
   - 预算成本 vs 实际成本对比图表
   - 利润分析（合同金额 - 总成本）
   - 成本明细（人力、差旅、外包）

5. **变更记录区域**：
   - 显示所有项目变更记录
   - 变更日期、变更类型、变更说明、审批状态
   - 操作按钮（查看详情、申请变更）

6. **任务列表区域**：
   - 显示项目关联的所有任务
   - 任务名称、执行者、状态、计划工时、实际工时
   - 操作按钮（创建任务、查看详情）

7. **业绩记录区域**：
   - 显示项目关联的业绩记录
   - 业绩金额、验收状态、结算状态、到账状态
   - 操作按钮（查看详情、登记业绩）

**交互设计**：
- 使用标签页组织不同区域的内容
- 支持展开/收起各个区域
- 支持跳转到相关模块（如任务管理、业绩管理）

### 2.4 预算管理

**功能描述**：
- 管理项目的人力预算、差旅预算、外包预算
- 支持添加、编辑、删除预算项
- 自动计算预算总额

**功能要求**：
1. **人力预算管理**：
   - 按员工级别（P0-P9, M0-M5）和城市类型（成都/杭州）录入人日数
   - 系统自动根据人日成本标准计算单价和总价
   - 支持批量导入和导出

2. **差旅预算管理**：
   - 录入差旅事项
   - 录入各项费用（大交通、住宿、小交通、餐补、其他）
   - 系统自动计算总价

3. **外包预算管理**：
   - 录入外包事项
   - 选择供应商
   - 录入金额

**交互设计**：
- 预算管理使用表格展示
- 支持行内编辑
- 支持批量操作

### 2.5 支出管理

**功能描述**：
- 管理项目的人力支出、差旅支出、外包支出
- 人力支出从Teambition同步或手动录入
- 差旅和外包支出手动录入

**功能要求**：
1. **人力支出管理**：
   - 从Teambition同步工时数据
   - 系统自动根据工时和人日成本标准计算成本
   - 支持手动录入和编辑

2. **差旅支出管理**：
   - 手动录入差旅事项和各项费用
   - 支持上传差旅凭证

3. **外包支出管理**：
   - 手动录入外包事项、供应商和金额
   - 支持上传外包合同或发票

**交互设计**：
- 支出管理使用表格展示
- 支持按月份筛选
- 支持导出支出明细

### 2.6 项目变更管理

**功能描述**：
- 支持项目信息变更申请
- 变更需要审批
- 记录变更历史

**功能要求**：
1. **变更申请**：
   - 选择变更类型（项目变更/需求变更）
   - 填写变更说明（必填）
   - 上传变更附件（必填）
   - 提交审批

2. **变更审批**：
   - 根据审批流程配置进行审批
   - 审批通过后，更新项目信息

3. **变更记录**：
   - 显示所有变更记录
   - 变更日期、变更类型、变更说明、审批状态

**交互设计**：
- 变更申请使用表单
- 变更记录使用列表展示

### 2.7 项目补录申请

**功能描述**：
- 计件制项目支持补录申请
- 补录申请需要审批
- 审批通过后，可以录入预算和业绩金额

**功能要求**：
1. **补录申请**：
   - 填写补录说明（必填）
   - 上传补录附件（必填）
   - 提交审批

2. **补录审批**：
   - 根据审批流程配置进行审批
   - 审批通过后，可以录入预算和业绩金额

**交互设计**：
- 补录申请使用表单
- 补录记录使用列表展示

### 2.8 设计确认

**功能描述**：
- 项目完成后，需要设计确认
- 设计确认需要审批
- 记录设计确认历史

**功能要求**：
1. **设计确认申请**：
   - 填写设计确认说明（可选）
   - 上传设计确认附件（可选）
   - 提交审批

2. **设计确认审批**：
   - 根据审批流程配置进行审批
   - 审批通过后，项目状态可以变为"待确认"

**交互设计**：
- 设计确认申请使用表单
- 设计确认记录使用列表展示

### 2.9 项目归档

**功能描述**：
- 项目完成后，可以归档
- 归档后的项目默认隐藏
- 归档时重新计算实际利润

**功能要求**：
1. **归档操作**：
   - 确认项目已完成
   - 点击归档按钮
   - 系统自动重新计算实际利润

2. **归档后**：
   - 项目状态变为"已归档"
   - 项目在列表中默认隐藏
   - 可以通过筛选条件查看归档项目

**交互设计**：
- 归档操作需要确认对话框
- 归档后的项目在列表中标记为"已归档"

## 三、功能优先级

### 3.1 P0（必须实现）

- 项目创建
- 项目列表
- 项目详情
- 预算管理
- 支出管理
- 项目变更管理

### 3.2 P1（重要功能）

- 项目补录申请
- 设计确认
- 项目归档
- 成本分析

### 3.3 P2（可选功能）

- 批量导入/导出
- 项目模板
- 项目复制

## 四、验收标准

### 4.1 功能验收

- 所有P0功能必须完整实现
- 所有P1功能必须完整实现
- 功能符合业务逻辑规则文档要求

### 4.2 性能验收

- 项目列表加载时间 < 2秒
- 项目详情加载时间 < 1秒
- 预算和支出数据计算准确

### 4.3 用户体验验收

- 界面友好，操作流畅
- 错误提示清晰
- 支持响应式设计

