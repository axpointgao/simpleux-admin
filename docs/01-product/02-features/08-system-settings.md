# 系统设置模块功能需求

## 一、功能概述

系统设置模块用于管理系统配置，包括人日成本设置、角色权限设置、审批流程设置、节假日管理、客户部管理、供应商管理、通知设置、系统参数设置等功能。

## 二、功能列表

### 2.1 人日成本设置

**功能描述**：
- 设置不同员工级别和城市类型的人日成本标准
- 支持设置生效时间范围，用于历史成本标准查询
- 支持启用/禁用成本标准

**功能要求**：

1. **成本标准管理**：
   - 查看成本标准列表（按员工级别和城市类型分组）
   - 创建新的成本标准
   - 编辑现有成本标准
   - 删除成本标准
   - 启用/禁用成本标准

2. **成本标准配置**：
   - 员工级别（必填，下拉选择：P0-P9, M0-M5）
   - 城市类型（必填，下拉选择：Chengdu/Hangzhou）
   - 人日成本（必填，数字输入，单位：元）
   - 生效开始日期（必填，日期选择器）
   - 生效结束日期（可选，日期选择器，为空表示永久有效）
   - 是否启用（必填，开关）

3. **业务规则**：
   - 同一员工级别和城市类型的成本标准，在同一时间段内只能有一条有效记录
   - 生效日期不能重叠
   - 成本标准可以设置生效时间范围，支持历史成本标准查询

**交互设计**：
- 成本标准列表使用表格展示
- 支持按员工级别、城市类型、生效日期筛选
- 支持批量导入和导出

### 2.2 角色权限设置

**功能描述**：
- 创建和管理系统角色
- 为角色分配权限
- 支持启用/禁用角色

**功能要求**：

1. **角色管理**：
   - 查看角色列表
   - 创建新角色
   - 编辑现有角色
   - 删除角色（系统角色不能删除）
   - 启用/禁用角色

2. **角色配置**：
   - 角色代码（必填，唯一，文本输入）
   - 角色名称（必填，文本输入）
   - 角色描述（可选，文本域）
   - 是否系统角色（必填，开关，系统角色不能删除）
   - 权限列表（必填，多选，权限树）

3. **权限管理**：
   - 查看权限列表（按模块分组）
   - 创建新权限
   - 编辑现有权限
   - 删除权限
   - 权限代码（必填，唯一，格式：`module.action`）
   - 权限名称（必填）
   - 所属模块（必填，下拉选择）
   - 操作类型（必填，下拉选择：create/edit/delete/view）

**交互设计**：
- 角色管理使用表格展示
- 权限分配使用权限树
- 支持按模块筛选权限

### 2.3 审批流程设置

**功能描述**：
- 为不同审批类型配置审批流程模板
- 支持多步骤审批
- 支持启用/禁用审批流程模板

**功能要求**：

1. **审批流程模板管理**：
   - 查看审批流程模板列表
   - 创建新审批流程模板
   - 编辑现有审批流程模板
   - 删除审批流程模板
   - 启用/禁用审批流程模板

2. **审批流程模板配置**：
   - 审批类型（必填，唯一，下拉选择）
   - 模板名称（必填，文本输入）
   - 模板描述（可选，文本域）
   - 审批步骤配置（必填，至少一个步骤）
   - 是否启用（必填，开关）

3. **审批步骤配置**：
   - 步骤索引（从0开始）
   - 步骤名称（必填，文本输入）
   - 审批人类型（必填，下拉选择：user/role）
   - 审批人ID（必填，具体用户ID或角色ID）
   - 是否必审（必填，开关，默认：true）

4. **业务规则**：
   - 每个审批类型只能有一个启用的审批流程模板
   - 审批步骤按索引顺序执行
   - 审批人可以是具体用户或角色

**交互设计**：
- 审批流程模板列表使用表格展示
- 审批步骤配置使用列表展示
   - 支持添加、编辑、删除步骤
   - 支持上移、下移步骤
   - 支持拖拽排序

### 2.4 节假日管理

**功能描述**：
- 管理节假日数据
- 支持自动同步和手动配置
- 用于工时计算，排除节假日

**功能要求**：

1. **节假日管理**：
   - 查看节假日列表（按年份分组）
   - 创建新节假日
   - 编辑现有节假日
   - 删除节假日
   - 批量导入节假日（Excel格式）

2. **节假日配置**：
   - 日期（必填，日期选择器，唯一）
   - 节假日名称（必填，文本输入）
   - 类型（必填，下拉选择：holiday/workday）
   - 年份（必填，用于快速查询）

3. **数据来源**：
   - **方案1**：使用第三方API自动获取（推荐）
   - **方案2**：手动配置
   - 支持两种方式混合使用

**交互设计**：
- 节假日列表使用表格展示
- 支持按年份筛选
- 支持批量导入和导出

### 2.5 客户部管理

**功能描述**：
- 管理客户部信息
- 客户部不在钉钉的组织架构中，需要手动维护
- 支持启用/禁用客户部

**功能要求**：

1. **客户部管理**：
   - 查看客户部列表
   - 创建新客户部
   - 编辑现有客户部
   - 删除客户部
   - 启用/禁用客户部

2. **客户部配置**：
   - 客户部代码（必填，唯一，文本输入）
   - 客户部名称（必填，文本输入）
   - 客户部描述（可选，文本域）
   - 是否启用（必填，开关）

**交互设计**：
- 客户部列表使用表格展示
- 支持按启用状态筛选

### 2.6 供应商管理

**功能描述**：
- 管理供应商信息
- 用于外包预算和支出记录
- 支持启用/禁用供应商

**功能要求**：

1. **供应商管理**：
   - 查看供应商列表
   - 创建新供应商
   - 编辑现有供应商
   - 删除供应商
   - 启用/禁用供应商

2. **供应商配置**：
   - 供应商名称（必填，唯一，文本输入）
   - 联系人（可选，文本输入）
   - 联系电话（可选，文本输入）
   - 邮箱（可选，文本输入）
   - 地址（可选，文本输入）
   - 是否启用（必填，开关）

**交互设计**：
- 供应商列表使用表格展示
- 支持按启用状态筛选

### 2.7 通知设置

**功能描述**：
- 配置各种通知的发送渠道和模板
- 支持启用/禁用通知
- 支持自定义通知模板

**功能要求**：

1. **通知配置管理**：
   - 查看通知配置列表
   - 创建新通知配置
   - 编辑现有通知配置
   - 删除通知配置
   - 启用/禁用通知配置

2. **通知配置**：
   - 通知类型（必填，下拉选择）
   - 通知渠道（必填，下拉选择：dingtalk）
   - 是否启用（必填，开关）
   - 通知模板（可选，JSON格式）

3. **通知类型**：
   - `approval`：审批通知
   - `project_status_change`：项目状态变更通知
   - `contribution_approval`：专业贡献审批通知
   - `performance_acceptance`：业绩验收通知

**交互设计**：
- 通知配置列表使用表格展示
- 支持测试通知发送

### 2.8 系统参数设置

**功能描述**：
- 管理系统参数和业务规则参数
- 支持按分类组织参数
- 支持文本和JSON格式的参数值

**功能要求**：

1. **系统参数管理**：
   - 查看系统参数列表（按分类分组）
   - 创建新系统参数
   - 编辑现有系统参数
   - 删除系统参数

2. **系统参数配置**：
   - 参数键（必填，唯一，文本输入）
   - 参数值（必填，文本或JSON格式）
   - 参数描述（可选，文本域）
   - 参数分类（可选，下拉选择：business/system）

3. **默认值和业务规则参数示例**：
   - `default_project_status`：默认项目状态
   - `default_task_status`：默认任务状态
   - `max_project_budget_amount`：项目预算最大金额
   - `work_hours_per_day`：每天标准工时

**交互设计**：
- 系统参数列表使用表格展示
- 支持按分类筛选
- 支持参数值编辑（文本编辑器或JSON编辑器）

## 三、功能优先级

### 3.1 P0（必须实现）

- 人日成本设置
- 角色权限设置
- 审批流程设置
- 节假日管理

### 3.2 P1（重要功能）

- 客户部管理
- 供应商管理
- 通知设置
- 系统参数设置

### 3.3 P2（可选功能）

- 批量导入/导出
- 参数模板
- 配置备份和恢复

## 四、验收标准

### 4.1 功能验收

- 所有P0功能必须完整实现
- 所有P1功能必须完整实现
- 功能符合业务逻辑规则文档要求
- 配置数据正确保存和读取

### 4.2 性能验收

- 设置页面加载时间 < 2秒
- 配置操作响应时间 < 1秒
- 批量导入响应时间 < 5秒

### 4.3 用户体验验收

- 界面友好，操作流畅
- 错误提示清晰
- 支持响应式设计
- 配置项组织清晰

