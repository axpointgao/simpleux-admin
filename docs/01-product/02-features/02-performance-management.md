# 业绩管理模块功能需求

## 一、功能概述

业绩管理模块用于管理项目的业绩全生命周期，包括业绩登记、验收、结算、到账、业绩拆分等功能。支持不同项目类型的业绩管理规则。

## 二、功能列表

### 2.1 业绩登记

**功能描述**：
- 支持为不同项目类型创建业绩记录
- 根据项目类型，业绩记录的创建时机和关联方式不同
- 业绩记录包含业绩金额、关联项目/需求等信息

**功能要求**：

1. **项目制业绩登记**：
   - 关联到项目（`project_id`）
   - 一个项目只有一条业绩记录
   - 业绩月份为空（`record_month` 为空）
   - 创建时机：项目立项审批通过后自动创建

2. **计件制业绩登记**：
   - 关联到需求编号和需求名称（`demand_code`、`demand_name`）
   - 一个需求只有一条业绩记录
   - 业绩月份为空（`record_month` 为空）
   - 创建时机：
     - 有预算：项目立项审批通过后自动创建
     - 待补录：补录审批通过后创建

3. **离岸制/驻场制业绩登记**：
   - 关联到项目（`project_id`）
   - 一个项目可以有多条业绩记录（按月）
   - 业绩月份必填（`record_month` 必填）
   - 创建时机：每月手动创建

4. **业绩信息录入**：
   - 业绩金额（必填，数字输入，单位：元）
   - 关联项目/需求信息（自动带出）
   - 业绩月份（离岸制/驻场制必填，其他为空）
   - 拆分金额（可选，用于业绩拆分）

**交互设计**：
- 业绩登记表单根据项目类型显示不同字段
- 项目制和计件制：显示项目/需求信息，不显示业绩月份
- 离岸制和驻场制：显示项目信息和业绩月份选择器
- 支持批量创建（离岸制/驻场制）

### 2.2 业绩列表

**功能描述**：
- 显示所有业绩记录列表
- 支持多维度筛选和搜索
- 支持排序和分页

**功能要求**：

1. **列表字段**：
   - 项目名称/需求名称
   - 项目类型
   - 业绩金额
   - 业绩月份（离岸制/驻场制显示）
   - 验收状态
   - 结算状态
   - 到账状态
   - 创建时间
   - 操作按钮（查看详情、编辑、删除）

2. **筛选条件**：
   - 项目类型（下拉选择，多选）
   - 验收状态（下拉选择，多选）
   - 结算状态（下拉选择，多选）
   - 到账状态（下拉选择，多选）
   - 归属部门（下拉选择，多选）
   - 客户部（下拉选择，多选）
   - 业绩月份（日期范围选择器，用于离岸制/驻场制）
   - 创建时间（日期范围选择器）

3. **排序**：
   - 默认按创建时间倒序
   - 支持按业绩金额、业绩月份、创建时间等字段排序

4. **分页**：
   - 每页显示20条记录
   - 支持跳转到指定页码

**交互设计**：
- 列表使用表格展示
- 筛选条件在列表顶部，支持展开/收起
- 支持批量操作（如批量导出）

### 2.3 业绩详情

**功能描述**：
- 显示业绩记录的完整信息
- 支持查看和管理验收、结算、到账记录
- 支持业绩拆分管理

**功能要求**：

1. **基本信息区域**：
   - 项目名称/需求名称、项目类型
   - 业绩金额、业绩月份（离岸制/驻场制显示）
   - 拆分金额、归属部门、客户部
   - 创建时间、更新时间
   - 操作按钮（编辑、删除）

2. **验收记录区域**：
   - 显示所有验收记录
   - 验收月份、验收金额、验收状态、验收人、验收时间
   - 操作按钮（创建验收、查看详情、编辑、删除）

3. **结算记录区域**：
   - 显示所有结算记录
   - 结算日期、结算金额、结算状态
   - 操作按钮（创建结算、查看详情、编辑、删除）

4. **到账记录区域**：
   - 显示所有到账记录
   - 到账日期、到账金额、到账状态
   - 操作按钮（创建到账、查看详情、编辑、删除）

5. **业绩拆分区域**：
   - 显示所有拆分记录
   - 拆分部门、拆分金额、拆分原因、拆分时间
   - 操作按钮（创建拆分、查看详情、编辑、删除）

6. **关联项目区域**：
   - 显示关联的项目信息
   - 支持跳转到项目详情页

**交互设计**：
- 使用标签页组织不同区域的内容
- 支持展开/收起各个区域
- 支持跳转到相关模块（如项目管理）

### 2.4 业绩验收

**功能描述**：
- 支持创建和管理业绩验收记录
- 验收记录包含验收月份、验收金额、验收状态等信息

**功能要求**：

1. **创建验收记录**：
   - 验收月份（必填，日期选择器）
   - 验收金额（必填，数字输入，单位：元）
   - 验收说明（可选，文本域）
   - 验收附件（可选，文件上传）
   - 提交后创建验收记录

2. **验收记录管理**：
   - 查看验收记录列表
   - 编辑验收记录（未验收状态）
   - 删除验收记录（未验收状态）
   - 标记验收状态（未验收/部分验收/全部验收）

3. **验收统计**：
   - 总验收金额
   - 验收进度（验收金额/业绩金额）
   - 验收记录数量

**交互设计**：
- 验收记录使用表格展示
- 支持按月份筛选
- 支持批量操作

### 2.5 业绩结算

**功能描述**：
- 支持创建和管理业绩结算记录
- 结算记录包含结算日期、结算金额、结算状态等信息

**功能要求**：

1. **创建结算记录**：
   - 结算日期（必填，日期选择器）
   - 结算金额（必填，数字输入，单位：元）
   - 结算说明（可选，文本域）
   - 提交后创建结算记录

2. **结算记录管理**：
   - 查看结算记录列表
   - 编辑结算记录（未结算状态）
   - 删除结算记录（未结算状态）
   - 标记结算状态（未结算/无需结算/发起结算/部分结算/全部结算）

3. **结算统计**：
   - 总结算金额
   - 结算进度（结算金额/业绩金额）
   - 结算记录数量

**交互设计**：
- 结算记录使用表格展示
- 支持按日期筛选
- 支持批量操作

### 2.6 业绩到账

**功能描述**：
- 支持创建和管理业绩到账记录
- 到账记录包含到账日期、到账金额、到账状态等信息

**功能要求**：

1. **创建到账记录**：
   - 到账日期（必填，日期选择器）
   - 到账金额（必填，数字输入，单位：元）
   - 到账说明（可选，文本域）
   - 提交后创建到账记录

2. **到账记录管理**：
   - 查看到账记录列表
   - 编辑到账记录（未到账状态）
   - 删除到账记录（未到账状态）
   - 标记到账状态（未到账/部分到账/全部到账）

3. **到账统计**：
   - 总到账金额
   - 到账进度（到账金额/业绩金额）
   - 到账记录数量

**交互设计**：
- 到账记录使用表格展示
- 支持按日期筛选
- 支持批量操作

### 2.7 业绩拆分

**功能描述**：
- 支持将业绩拆分给其他部门
- 用于跨部门资源借用的业绩分配
- 拆分记录包含拆分部门、拆分金额、拆分原因等信息

**功能要求**：

1. **创建拆分记录**：
   - 拆分部门（必填，下拉选择）
   - 拆分金额（必填，数字输入，单位：元）
   - 拆分原因（必填，文本域）
   - 提交后创建拆分记录

2. **拆分记录管理**：
   - 查看拆分记录列表
   - 编辑拆分记录（可选）
   - 删除拆分记录（可选）

3. **拆分统计**：
   - 总拆分金额
   - 拆分部门统计
   - 拆分记录数量

**业务规则**：
- 拆分金额不能超过业绩金额
- 拆分总额不能超过业绩金额
- 拆分记录由项目归属部门主管管理

**交互设计**：
- 拆分记录使用表格展示
- 支持按部门筛选
- 支持批量操作

## 三、功能优先级

### 3.1 P0（必须实现）

- 业绩登记
- 业绩列表
- 业绩详情
- 业绩验收
- 业绩结算
- 业绩到账

### 3.2 P1（重要功能）

- 业绩拆分
- 业绩统计
- 批量操作

### 3.3 P2（可选功能）

- 业绩报表
- 业绩分析
- 业绩导出

## 四、验收标准

### 4.1 功能验收

- 所有P0功能必须完整实现
- 所有P1功能必须完整实现
- 功能符合业务逻辑规则文档要求
- 不同项目类型的业绩管理规则正确实现

### 4.2 性能验收

- 业绩列表加载时间 < 2秒
- 业绩详情加载时间 < 1秒
- 业绩统计数据计算准确

### 4.3 用户体验验收

- 界面友好，操作流畅
- 错误提示清晰
- 支持响应式设计
- 不同项目类型的界面适配正确

