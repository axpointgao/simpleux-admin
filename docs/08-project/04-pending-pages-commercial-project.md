# 商业项目管理模块待完成页面清单

> **注意**：本文档已归档。所有功能均已完成，请参考 `05-commercial-project-pages-status.md` 查看最新状态。

## 一、已完成的页面

### ✅ 已完成
1. **项目列表页** (`/projects/list`)
   - 路径：`simpleux-admin/src/pages/projects/list/index.tsx`
   - 状态：✅ 已完成
   - 功能：列表展示、筛选、分页、详情抽屉

2. **项目创建页** (`/projects/create`)
   - 路径：`simpleux-admin/src/pages/projects/create/index.tsx`
   - 状态：✅ 已完成（⚠️ 待优化：需要实现分步骤向导）
   - 功能：项目创建表单、类型选择、预算录入、交付计划

3. **项目详情抽屉** (在列表页中)
   - 路径：`simpleux-admin/src/pages/projects/list/detail-drawer.tsx`
   - 状态：✅ 已完成
   - 功能：基本信息、预算明细、支出明细、变更记录、阶段管理

4. **阶段进度管理弹窗** (在详情抽屉中)
   - 路径：`simpleux-admin/src/pages/projects/list/stage-progress-modal.tsx`
   - 状态：✅ 已完成
   - 功能：阶段状态操作、完成百分比设置、附件上传

---

## 二、待完成的页面

### P0（必须实现）

#### 1. 项目变更申请页面/弹窗
**功能描述**：
- 支持项目信息变更申请
- 变更需要审批
- 记录变更历史

**功能要求**：
- 选择变更类型（项目变更/需求变更，计件制项目需要选择）
- 填写变更说明（必填）
- 上传变更附件（必填）
- 可变更字段：
  - 项目制：项目名称、项目经理、归属部门、商务经理、归属客户部、计划开始/结束日期、业绩金额、阶段、预算
  - 计件制主项目变更：计件项目相关信息（项目经理、归属部门、商务经理、归属客户部）
  - 计件制需求变更：需求名称、计划时间、业绩金额、阶段、预算
- 提交审批

**交互设计**：
- 可以使用弹窗（Modal）或独立页面
- 变更申请使用表单
- 变更记录在详情页的"变更记录"Tab中显示

**优先级**：P0

**当前状态**：
- 详情页有"项目变更"按钮，但功能未实现（显示"项目变更功能开发中"）
- 变更记录Tab已实现，但数据为空

---

#### 2. 项目补录申请页面/弹窗
**功能描述**：
- 计件制项目支持补录申请
- 补录申请需要审批
- 审批通过后，可以录入预算和业绩金额

**功能要求**：
- 填写补录说明（必填）
- 上传补录附件（必填）
- 填写需求金额（必填，必须 > 0）
- 选择阶段模板（必填，如果之前没有选择阶段模板）
- 录入预算：人力预算必填，差旅和外包可选
- 阶段占比验证：所有阶段占比之和必须等于100%
- 提交审批

**交互设计**：
- 可以使用弹窗（Modal）或独立页面
- 补录申请使用表单
- 补录记录在详情页显示

**优先级**：P0

**当前状态**：
- 详情页有"提交补录申请"按钮，但功能未实现（显示"提交补录申请功能开发中"）
- 列表页操作菜单中有"提交补录申请"选项，但功能未实现

---

**说明**：预算管理功能已实现为只读查看模式。预算的修改只能通过项目变更流程进行，详见"项目变更申请页面/弹窗"功能。

---

**说明**：支出管理功能已取消。支出录入在成本管理模块中进行，项目详情页仅提供支出数据的只读查看功能。

---

### P1（重要功能）

#### 5. 设计确认申请页面/弹窗
**功能描述**：
- 项目完成后，需要设计确认
- 设计确认需要审批
- 记录设计确认历史

**功能要求**：
- 填写设计确认说明（可选）
- 上传设计确认附件（可选，但文档要求必填）
- 提交审批

**交互设计**：
- 可以使用弹窗（Modal）
- 设计确认申请使用表单
- 设计确认记录在详情页显示

**优先级**：P1

**当前状态**：
- 详情页有"发起设计确认"按钮，但功能未实现（显示"发起设计确认功能开发中"）

---

#### 6. 项目归档页面/弹窗
**功能描述**：
- 项目完成后，可以归档
- 归档后的项目默认隐藏
- 归档时重新计算实际利润

**功能要求**：
- 归档操作：
  - 确认项目已完成
  - 显示固定提示："请确定差旅和外包支出都已录入后再进行归档"
  - 显示财务指标（业绩金额、实际利润、实际利润率）
  - 填写归档说明（可选）
  - 点击归档按钮
  - 提交审批
- 归档审批：
  - 根据审批流程配置进行审批
  - 审批通过后，根据实际支出重新计算实际利润
  - 项目状态变为"已归档"
  - 项目默认隐藏（不显示在列表中）
- 取消归档：
  - 已归档项目可以取消归档
  - 不需要审批，直接取消归档
  - 项目状态变为"已确认"

**交互设计**：
- 可以使用弹窗（Modal）或确认对话框
- 归档操作需要确认对话框
- 归档后的项目在列表中标记为"已归档"

**优先级**：P1

**当前状态**：
- 详情页有"发起归档"按钮，但功能未实现（显示"发起归档功能开发中"）
- 详情页有"取消归档"按钮，但功能未实现（只有确认对话框，没有实际API调用）

---

**说明**：成本分析功能已取消，不再实现。

---

### P2（可选功能）

**说明**：项目编辑功能已取消，项目信息修改需通过项目变更流程进行。

**当前状态**：
- 项目创建页面已支持编辑模式（通过URL参数 `id` 判断）
- 但编辑功能未完全实现（需要加载现有数据）

---

#### 9. 计件项目管理页面
**功能描述**：
- 创建和管理计件项目（主项目）
- 用于计件制项目关联

**功能要求**：
- 创建计件项目
- 编辑计件项目
- 计件项目列表
- 计件项目详情

**交互设计**：
- 可以使用独立页面或弹窗
- 在项目创建页的"计件项目"选择器中，有"创建计件项目"按钮，但功能未实现

**优先级**：P2

**当前状态**：
- 项目创建页有"创建计件项目"按钮，但功能未实现（显示"创建计件项目功能待实现"）

---

#### 10. 批量导入/导出功能
**功能描述**：
- 批量导入项目
- 批量导出项目
- 批量导入预算
- 批量导出预算/支出

**功能要求**：
- 批量导入项目（Excel）
- 批量导出项目（Excel）
- 批量导入预算（Excel）
- 批量导出预算/支出（Excel）

**交互设计**：
- 在列表页添加"批量导入"和"批量导出"按钮
- 在预算管理中添加"批量导入"和"批量导出"按钮

**优先级**：P2

**当前状态**：
- 未实现

---

## 三、页面实现优先级总结

### P0（必须实现）- 4个页面/功能
1. ✅ 项目变更申请页面/弹窗
2. ✅ 项目补录申请页面/弹窗
3. ✅ 预算管理功能（添加/编辑/删除预算）
4. ✅ 支出管理功能（添加/编辑/删除支出、同步工时）

### P0（必须实现）- 2个页面/功能
5. ❌ 设计确认申请页面/弹窗
6. ❌ 项目归档页面/弹窗（包含预算与支出核对）

### P2（可选功能）- 1个页面/功能
9. ❌ 计件项目管理页面

**已取消的功能**：
- ❌ 成本分析页面/区域（功能7，不再实现）
- ❌ 项目编辑页面（功能8，不再实现）
- ❌ 批量导入/导出功能（功能10，不再实现）

---

## 四、实现建议

### 1. 弹窗 vs 独立页面
- **项目变更申请**：建议使用弹窗（Modal），因为变更内容与项目创建表单类似
- **项目补录申请**：建议使用弹窗（Modal），因为补录内容与项目创建表单类似
- **预算管理**：已在详情页Tab中实现为只读查看模式，预算修改需通过项目变更流程
- **支出查看**：已在详情页Tab中实现为只读查看模式，支出录入在成本管理模块中进行
- **设计确认申请**：建议使用弹窗（Modal），内容简单
- **项目归档**：建议使用弹窗（Modal），包含预算与支出核对流程
**说明**：成本分析功能已取消，不再实现。

### 2. 技术实现
- 使用 Arco Design 的 Modal、Drawer、Form 组件
- 复用项目创建页面的表单组件和验证逻辑
- 支出管理可以在详情页Tab中实现，使用 Table 的行内编辑或弹窗编辑

### 3. 数据接口
- 需要实现以下API接口：
  - 项目变更申请API（包含预算修改）
  - 项目补录申请API（包含预算录入）
  - Teambition同步工时API
  - 设计确认申请API
  - 项目归档API

---

## 五、当前开发进度（已全部完成）

### 已完成（100%）
- ✅ 项目列表页
- ✅ 项目创建页（单页表单，待优化为分步骤向导）
- ✅ 项目详情抽屉（查看功能完整）
- ✅ 阶段进度管理
- ✅ 项目变更申请页面
- ✅ 项目补录申请页面
- ✅ 设计确认申请弹窗
- ✅ 项目归档弹窗
- ✅ 计件项目管理页面

**已取消的功能**：
- ❌ 成本分析（不再实现）
- ❌ 项目编辑（不再实现）
- ❌ 批量导入/导出（不再实现）

---

## 六、下一步开发建议

**所有功能已完成，请参考 `05-commercial-project-pages-status.md` 查看最新状态和优化建议。**

