# 其他任务模块功能需求

## 一、功能概述

其他任务模块用于管理主管给下属分配的其他任务，这些任务不属于商业项目、售前支持、专业贡献等业务实体。其他任务本质上是任务实体，通过`entityType = 'other_task'`标识。

## 二、功能列表

### 2.1 任务创建

**功能描述**：
- 主管可以为下属创建其他任务
- 其他任务直接是任务实体，不是容器
- 任务创建后状态默认为"进行中"

**功能要求**：

1. **任务基本信息录入**：
   - 任务名称（必填，文本输入）
   - 任务描述（可选，文本域）
   - 任务执行人（必填，下拉选择，选择下属）
   - 开始日期（可选，日期选择器）
   - 结束日期（可选，日期选择器）
   - 优先级（可选，下拉选择：low/medium/high）

2. **任务关联**：
   - 任务自动设置`entityType = 'other_task'`
   - 任务自动设置`entityId`（可以使用任务ID或生成唯一标识）

3. **任务创建权限**：
   - 只有归属部门主管可以创建其他任务
   - 主管只能为本部门的下属创建任务

4. **创建流程**：
   - 填写任务基本信息
   - 提交后创建任务
   - 任务状态默认为"进行中"

**交互设计**：
- 任务创建表单使用弹窗或页面
- 表单验证和错误提示
- 支持快速创建（简化表单）

### 2.2 任务列表

**功能描述**：
- 显示所有其他任务列表
- 支持多维度筛选和搜索
- 支持排序和分页

**功能要求**：

1. **列表字段**：
   - 任务名称
   - 执行者
   - 创建者
   - 归属部门
   - 任务状态
   - 计划工时（总工时）
   - 实际工时（总工时）
   - 工时完成率
   - 创建时间
   - 操作按钮（查看详情、编辑、删除）

2. **筛选条件**：
   - 任务状态（下拉选择，多选）
   - 执行者（下拉选择，多选）
   - 创建者（下拉选择，多选）
   - 归属部门（下拉选择，多选）
   - 任务名称（文本输入，模糊搜索）
   - 创建时间（日期范围选择器）

3. **排序**：
   - 默认按创建时间倒序
   - 支持按计划工时、实际工时、创建时间等字段排序

4. **分页**：
   - 每页显示20条记录
   - 支持跳转到指定页码

**交互设计**：
- 列表使用表格展示
- 筛选条件在列表顶部，支持展开/收起
- 支持批量操作（如批量导出）

### 2.3 任务详情

**功能描述**：
- 显示任务的完整信息
- 支持查看和管理计划工时、实际工时
- 支持工时统计和分析

**功能要求**：

1. **基本信息区域**：
   - 任务名称、任务描述、执行者、创建者、创建时间、状态
   - 操作按钮（编辑、删除、完成、取消）

2. **计划工时列表**：
   - 按日期显示计划工时
   - 显示分配模式（合计工时模式/每天工时模式）
   - 显示总计划工时和每天计划工时
   - 操作按钮（添加计划工时、编辑、删除）

3. **实际工时列表**：
   - 按日期显示实际工时
   - 显示录入模式（合计工时模式/每天工时模式）
   - 显示总实际工时和每天实际工时
   - 操作按钮（录入实际工时、编辑、删除）

4. **工时统计**：
   - 总计划工时、总实际工时、工时差异、完成率
   - 工时对比图表（计划工时 vs 实际工时）
   - 按日期统计工时

**交互设计**：
- 使用标签页组织不同区域的内容
- 支持展开/收起各个区域

### 2.4 计划工时分配

**功能描述**：
- 支持为其他任务分配计划工时
- 支持两种分配模式：合计工时模式和每天工时模式
- 系统自动排除节假日和周末
- 只有归属部门主管可以分配计划工时

**功能要求**：

1. **分配模式选择**：
   - **合计工时模式**：输入总计划工时，系统自动均分到每个工作日
   - **每天工时模式**：输入每天计划工时，系统为每个工作日分配相同工时

2. **日期区间选择**：
   - 开始日期（必填，日期选择器）
   - 结束日期（必填，日期选择器）
   - 系统自动计算工作日数量（排除节假日和周末）

3. **工时输入**：
   - 合计工时模式：输入总计划工时（小时，支持小数）
   - 每天工时模式：输入每天计划工时（小时，支持小数）

4. **自动计算**：
   - 合计工时模式：系统自动计算每天计划工时
   - 每天工时模式：系统自动计算总计划工时

**交互设计**：
- 计划工时分配弹窗
- 显示工作日数量（只读）
- 显示计算结果（只读）
- 支持预览分配结果

### 2.5 实际工时录入

**功能描述**：
- 支持任务执行者录入实际工时
- 支持两种录入模式：合计工时模式和每天工时模式
- 系统自动排除节假日和周末
- 只有任务执行者本人可以录入实际工时

**功能要求**：

1. **录入模式选择**：
   - **合计工时模式**：输入总工时，系统自动均分到每个工作日
   - **每天工时模式**：输入每天工时，系统为每个工作日录入相同工时

2. **日期区间选择**：
   - 开始日期（必填，日期选择器）
   - 结束日期（必填，日期选择器）
   - 系统自动计算工作日数量（排除节假日和周末）

3. **工时输入**：
   - 合计工时模式：输入总工时（小时，支持小数，>= 0）
   - 每天工时模式：输入每天工时（小时，支持小数，>= 0）

4. **自动计算**：
   - 合计工时模式：系统自动计算每天实际工时和总实际工时
   - 每天工时模式：系统自动计算总实际工时

**交互设计**：
- 实际工时录入弹窗
- 显示工作日数量（只读）
- 显示计算结果（只读）
- 支持预览录入结果

## 三、功能优先级

### 3.1 P0（必须实现）

- 任务创建
- 任务列表
- 任务详情
- 计划工时分配
- 实际工时录入

### 3.2 P1（重要功能）

- 工时统计
- 批量操作

### 3.3 P2（可选功能）

- 工时报表
- 工时分析
- 工时导出

## 四、验收标准

### 4.1 功能验收

- 所有P0功能必须完整实现
- 所有P1功能必须完整实现
- 功能符合业务逻辑规则文档要求
- 两种分配模式正确实现
- 节假日排除功能正确实现

### 4.2 性能验收

- 任务列表加载时间 < 2秒
- 任务详情加载时间 < 1秒
- 工时统计数据计算准确

### 4.3 用户体验验收

- 界面友好，操作流畅
- 错误提示清晰
- 支持响应式设计

